# üé¨ Movie History Data Engineering Project

## üìã Descripci√≥n del Proyecto

Proyecto integral de ingenier√≠a de datos que implementa un pipeline completo de ETL/ELT utilizando **Azure Databricks**, **PySpark**, **SQL** y **Azure Data Lake Storage Gen2**, siguiendo las mejores pr√°cticas de la **Arquitectura Medallion** (Bronze, Silver, Gold). El proyecto procesa y analiza datos hist√≥ricos de pel√≠culas, aplicando transformaciones complejas y generando insights de negocio.

---

## üéØ Objetivos del Proyecto

- Implementar un pipeline de datos escalable y robusto utilizando tecnolog√≠as cloud de Azure
- Aplicar la arquitectura Medallion para garantizar calidad y gobernanza de datos
- Procesar m√∫ltiples formatos de datos (CSV, JSON) con diferentes estructuras
- Implementar seguridad mediante Azure Key Vault y Service Principal
- Generar an√°lisis de negocio sobre presupuestos, ingresos y tendencias de la industria cinematogr√°fica
- Demostrar competencias en ingenier√≠a de datos utilizando herramientas enterprise-grade

---

## üèóÔ∏è Arquitectura del Proyecto

### Arquitectura Medallion

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     AZURE DATA LAKE GEN2                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   BRONZE     ‚îÇ  ‚îÄ‚îÄ> ‚îÇ   SILVER     ‚îÇ  ‚îÄ‚îÄ> ‚îÇ    GOLD      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ              ‚îÇ      ‚îÇ              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Raw Data     ‚îÇ      ‚îÇ Cleaned &    ‚îÇ      ‚îÇ Business     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ CSV/JSON     ‚îÇ      ‚îÇ Validated    ‚îÇ      ‚îÇ Aggregated   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ Delta Tables ‚îÇ      ‚îÇ Analytics    ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üë                        ‚Üë                      ‚Üë
         ‚îÇ                        ‚îÇ                      ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê             ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Ingesta ‚îÇ              ‚îÇ Trans ‚îÇ             ‚îÇ An√°lisis‚îÇ
    ‚îÇ         ‚îÇ              ‚îÇ forma ‚îÇ             ‚îÇ         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **Bronze Layer (Raw Data)**
- Almacena datos en su formato original (CSV, JSON)
- Sin transformaciones, datos tal como se reciben de la fuente
- Esquemas definidos para validaci√≥n inicial
- Soporta m√∫ltiples formatos: single-line JSON, multi-line JSON, CSV

#### **Silver Layer (Cleaned & Validated)**
- Datos limpios, normalizados y validados
- Formato Delta Lake para ACID transactions
- Columnas renombradas seg√∫n convenciones de negocio
- Particionamiento por fecha para optimizaci√≥n de queries
- Implementaci√≥n de merge/upsert para actualizaciones incrementales

#### **Gold Layer (Business Analytics)**
- Datos agregados y listos para consumo de BI
- Modelos dimensionales y m√©tricas de negocio
- Optimizado para performance en queries anal√≠ticas
- Resultados precalculados para dashboards y reportes

---

## üõ†Ô∏è Stack Tecnol√≥gico

### Cloud & Storage
- **Azure Databricks**: Plataforma de procesamiento distribuido
- **Azure Data Lake Storage Gen2 (ADLS)**: Almacenamiento de datos a escala
- **Azure Key Vault**: Gesti√≥n segura de secretos y credenciales
- **Azure Entra ID (Active Directory)**: Autenticaci√≥n y autorizaci√≥n

### Processing & Analytics
- **Apache Spark**: Motor de procesamiento distribuido
- **PySpark**: API de Python para Spark (DataFrames, SQL)
- **Delta Lake**: Capa de almacenamiento con ACID transactions
- **Spark SQL**: Queries anal√≠ticas sobre datos distribuidos

### Lenguajes
- **Python**: L√≥gica de transformaci√≥n y procesamiento
- **SQL**: Queries anal√≠ticas y creaci√≥n de objetos
- **Databricks Notebooks**: Desarrollo interactivo

### Seguridad
- **Service Principal**: Autenticaci√≥n OAuth para acceso a ADLS
- **Databricks Secrets**: Gesti√≥n de credenciales encriptadas
- **RBAC (Role-Based Access Control)**: Control de acceso granular

---

## üìä Modelo de Datos

### Entidades Principales

#### Dimensionales
- **Movies**: Informaci√≥n de pel√≠culas (t√≠tulo, presupuesto, ingresos, duraci√≥n, votos)
- **Languages**: Idiomas de las pel√≠culas
- **Genres**: G√©neros cinematogr√°ficos
- **Countries**: Pa√≠ses de producci√≥n
- **Production Companies**: Compa√±√≠as productoras
- **Persons**: Actores y personal de producci√≥n

#### Relacionales (Bridge Tables)
- **Movie_Genres**: Relaci√≥n muchos-a-muchos entre pel√≠culas y g√©neros
- **Movie_Languages**: Idiomas asociados a cada pel√≠cula
- **Movie_Cast**: Cast de actores por pel√≠cula
- **Movie_Companies**: Compa√±√≠as productoras por pel√≠cula
- **Production_Country**: Pa√≠ses de producci√≥n por pel√≠cula

### Esquema de Datos

**Total de registros procesados**:
- Pel√≠culas: ~4,500
- Relaciones g√©nero-idioma-pel√≠cula: 20,031 combinaciones
- Compa√±√≠as y pa√≠ses: 6,477 relaciones

---

## üîÑ Pipeline de Datos

### 1Ô∏è‚É£ Ingestion (Bronze ‚Üí Silver)

**Procesos implementados**:

```python
# Lectura de datos con esquema definido
movie_df = spark.read \
    .option("header", True) \
    .schema(movie_schema) \
    .csv(f"{bronze_folder_path}/{v_file_date}/movie.csv")

# Transformaciones: selecci√≥n, renombrado, adici√≥n de metadata
movies_final_df = add_ingestion_date(movies_renamed_df) \
    .withColumn("enviroment", lit(v_enviroment)) \
    .withColumn("file_date", lit(v_file_date))

# Escritura en Delta Lake con merge/upsert
merge_delta_lake(movies_final_df, "movie_silver", "movies", 
                 silver_folder_path, merge_condition, "file_date")
```

**Notebooks de Ingesta** (13 notebooks):
1. `01-Ingestion_file_movie.ipynb` - Datos principales de pel√≠culas
2. `02-ingestion_file_languaje.ipynb` - Cat√°logo de idiomas
3. `03-ingestion_file_genre.ipynb` - Cat√°logo de g√©neros
4. `04-ingestion_file_country.ipynb` - Cat√°logo de pa√≠ses
5. `05-ingestion_file_person.ipynb` - Datos de personas (JSON complejo)
6. `06-ingestion_file_movie_genre.ipynb` - Relaci√≥n pel√≠cula-g√©nero
7. `07-ingestion_file_movie_cast.ipynb` - Cast de pel√≠culas (JSON multil√≠nea)
8. `08-ingestion_file_language_role.ipynb` - Roles de idioma
9. `09-ingestion_folder_production_company.ipynb` - Compa√±√≠as productoras
10. `10-ingestion_folder_movie_company.ipynb` - Relaci√≥n pel√≠cula-compa√±√≠a
11. `11-ingestion_folder_movie_languages.ipynb` - Relaci√≥n pel√≠cula-idioma
12. `12-ingestion_folder_production_country.ipynb` - Pa√≠ses de producci√≥n
13. `13-create_silver_database.ipynb` - Creaci√≥n de base de datos Silver

**Caracter√≠sticas clave**:
- ‚úÖ Parametrizaci√≥n con widgets (`p_file_date`, `p_enviroment`)
- ‚úÖ Validaci√≥n de esquemas
- ‚úÖ Particionamiento por fecha
- ‚úÖ Merge incremental (upsert) para evitar duplicados
- ‚úÖ Metadata de auditor√≠a (ingestion_date, enviroment)

### 2Ô∏è‚É£ Transformation (Silver ‚Üí Gold)

**Notebooks de Transformaci√≥n** (6 notebooks):

#### **01. results_movies_genre_language**
Combina pel√≠culas con sus g√©neros e idiomas
```python
# Joins m√∫ltiples
results_df = movie_filter_df \
    .join(languages_mov_lan_df, "movie_id", "inner") \
    .join(genres_mov_gen_df, "movie_id", "inner")

# Filtrado por a√±o >= 2000
movie_filter_df = movies_df.filter("year_release_date >= 2000")
```
**Output**: 20,031 registros combinando pel√≠culas, g√©neros e idiomas

#### **02. results_country_prod_company**
An√°lisis de presupuesto e ingresos por pa√≠s y compa√±√≠a
```sql
SELECT title, budget, revenue, duration_time, release_date, 
       country_name, company_name, created_date
FROM movies 
JOIN production_countries ON ...
JOIN production_companies ON ...
```
**Output**: 6,477 registros con presupuestos promedio de $43.3M y ingresos de $124M

#### **03. results_group_movie_genre**
Agregaciones por g√©nero y a√±o
```python
results_group_by_df = results_df \
    .groupBy("year_release_date", "genre_name") \
    .agg(
        sum("budget").alias("total_budget"),
        sum("revenue").alias("total_revenue")
    )
    
# Ranking con window functions
results_dense_rank_df = Window.partitionBy("year_release_date") \
    .orderBy(desc("total_budget"), desc("total_revenue"))
```
**Insights**:
- **Adventure** es el g√©nero con mayor presupuesto ($3.3B en 2015)
- **Action** el segundo con $2.9B
- **Science Fiction** tercero con $2.1B

#### **04. results_group_movie_country**
Agregaciones por pa√≠s y a√±o
```python
# Ranking de pa√≠ses por ingresos totales
dense_rank_window = Window.partitionBy("year_release_date") \
    .orderBy(desc("total_revenue"))
```
**Insights**:
- **USA** lidera con $21.7B en ingresos (2015)
- **UK** segundo con $1.9B
- **Australia** tercero con $1.1B

### 3Ô∏è‚É£ Analysis (Gold Layer)

**Notebooks de An√°lisis** (4 notebooks):

1. **01.budget_revenue_country.ipynb**
   - An√°lisis de ROI por pa√≠s
   - Comparativa de presupuestos vs ingresos
   
2. **02.budget_revenue_production_company.ipynb**
   - Performance de compa√±√≠as productoras
   - Identificaci√≥n de estudios m√°s rentables

3-4. **Notebooks de an√°lisis adicionales** con agregaciones complejas

---

## üîê Seguridad e Infraestructura

### Configuraci√≥n de Service Principal

```python
# Autenticaci√≥n OAuth con Azure AD
client_id = dbutils.secrets.get(
    scope="movie-history-secret-scope",
    key="client-id"
)
tenant_id = dbutils.secrets.get(
    scope="movie-history-secret-scope",
    key="tenant-id"
)
client_secret = dbutils.secrets.get(
    scope="movie-history-secret-scope",
    key="client-secret"
)

spark.conf.set("fs.azure.account.auth.type.moviehistory0001.dfs.core.windows.net", 
               "OAuth")
spark.conf.set("fs.azure.account.oauth.provider.type.moviehistory0001.dfs.core.windows.net",
               "org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider")
```

**Ventajas de esta implementaci√≥n**:
- ‚úÖ Sin credenciales hardcodeadas en el c√≥digo
- ‚úÖ Rotaci√≥n de secretos sin cambios en notebooks
- ‚úÖ Control de acceso basado en roles (RBAC)
- ‚úÖ Auditor√≠a completa de accesos

### M√©todos de Autenticaci√≥n Implementados

1. **Access Key** (desarrollo)
2. **SAS Token** (acceso temporal)
3. **Service Principal** (producci√≥n) ‚≠ê Recomendado

---

## üöÄ Funciones Reutilizables

### Common Functions (`includes/common_functions.ipynb`)

#### 1. **add_ingestion_date**
```python
def add_ingestion_date(input_df):
    """Agrega timestamp de ingesta para auditor√≠a"""
    output_df = input_df.withColumn('ingestion_date', current_timestamp())
    return output_df
```

#### 2. **merge_delta_lake**
```python
def merge_delta_lake(input_df, db_name, table_name, folder_path, 
                     merge_condition, partition_column):
    """
    Realiza merge (upsert) en Delta Lake
    - Actualiza registros existentes
    - Inserta nuevos registros
    - Evita duplicados
    """
    from delta.tables import DeltaTable
    
    if spark._jsparkSession.catalog().tableExists(f"{db_name}.{table_name}"):
        deltaTable = DeltaTable.forPath(spark, f'{folder_path}/{table_name}')
        
        deltaTable.alias('tgt') \
            .merge(input_df.alias('src'), merge_condition) \
            .whenMatchedUpdateAll() \
            .whenNotMatchedInsertAll() \
            .execute()
    else:
        input_df.write.mode("overwrite") \
            .partitionBy(partition_column) \
            .format("delta") \
            .saveAsTable(f"{db_name}.{table_name}")
```

#### 3. **overwrite_partition**
```python
def overwrite_partition(input_df, db_name, table_name, partition_column):
    """Sobrescribe particiones espec√≠ficas sin afectar otras"""
    for item_list in input_df.select(f'{partition_column}').distinct().collect():
        if (spark._jsparkSession.catalog().tableExists(f"{db_name}.{table_name}")):
            spark.sql(f'ALTER TABLE {db_name}.{table_name} \
                       DROP IF EXISTS PARTITION ({partition_column} = "{item_list[partition_column]}")')
```

---

## üìà Resultados y M√©tricas del Proyecto

### Datasets Generados (Gold Layer)

| Dataset | Registros | Descripci√≥n |
|---------|-----------|-------------|
| `results_movie_genre_language` | 20,031 | Pel√≠culas con g√©neros e idiomas |
| `results_movie_genre_language_py` | 20,031 | Implementaci√≥n PySpark |
| `results_movie_genre_language_ext_sql` | 1,269 | Versi√≥n SQL extendida |
| `results_country_prod_company` | 6,477 | An√°lisis por pa√≠s y compa√±√≠a |
| `results_group_movie_genre` | 38 | Agregaciones por g√©nero |
| `results_group_movie_country` | 46 | Agregaciones por pa√≠s |

### Insights de Negocio

#### üìä Por G√©nero (2015-2017)
| G√©nero | Presupuesto Total | Ingresos Totales | ROI | Ranking |
|--------|-------------------|------------------|-----|---------|
| Adventure | $3.31B | $11.31B | 342% | #1 |
| Action | $2.92B | $10.59B | 363% | #2 |
| Science Fiction | $2.15B | $7.31B | 340% | #3 |

**Conclusiones**:
- **Action** ofrece el mejor ROI (363%), superando a Adventure a pesar de menor inversi√≥n total
- Los 3 g√©neros top concentran **~$8.4B en presupuestos** pero generan **~$29.2B en ingresos**
- **Adventure** domina en volumen absoluto, ideal para estudios con alto capital
- **Science Fiction** mantiene ROI competitivo con menor riesgo de inversi√≥n
- Estrategia recomendada: H√≠bridos Action-Adventure maximizan audiencia y rentabilidad

#### üåç Por Pa√≠s (2015-2016)
| Pa√≠s | Ingresos Totales | % del Mercado | Ranking |
|------|------------------|---------------|---------|
| United States of America | $21.73B | 87.3% | #1 |
| United Kingdom | $1.89B | 7.6% | #2 |
| Australia | $1.09B | 4.4% | #3 |

**Conclusiones**:
- **USA domina** con casi 9 de cada 10 d√≥lares generados en la industria
- **UK** se posiciona como segundo hub, aprovechando infraestructura y talento local
- **Australia** emerge como mercado en crecimiento (4.4%), atractivo por incentivos fiscales
- Concentraci√≥n geogr√°fica indica **altas barreras de entrada** en producci√≥n cinematogr√°fica
- Oportunidad: Co-producciones internacionales para acceder a m√∫ltiples mercados

#### üí∞ An√°lisis de Rentabilidad
| M√©trica | Valor | Insight |
|---------|-------|---------|
| **Presupuesto Promedio** | $43.3M | Punto medio para producciones comerciales |
| **Ingresos Promedio** | $124M | Retorno esperado en condiciones normales |
| **ROI Promedio** | 286% | Industria altamente rentable vs otras inversiones |
| **Presupuesto Mediano** | $25M | 50% de pel√≠culas producidas por debajo de esta cifra |
| **Duraci√≥n √ìptima** | 104-118 min | 50% de pel√≠culas en este rango (percentil 25-75) |

**Conclusiones**:
- El **ROI de 286%** supera ampliamente inversiones tradicionales (bolsa ~10% anual)
- La diferencia entre media ($43.3M) y mediana ($25M) indica que **mega-producciones** elevan el promedio
- Pel√≠culas de **presupuesto medio ($25M)** ofrecen mejor relaci√≥n riesgo-beneficio
- Duraci√≥n de **100-110 minutos** maximiza engagement sin fatiga de audiencia
- **Presupuestos >$150M** son apuestas de alto riesgo pero potencial de recompensa exponencial

#### üé¨ Calidad vs Comercial
| Rating Range | % de Pel√≠culas | Observaci√≥n |
|--------------|----------------|-------------|
| 0.0 - 5.5 | 25% | Bajo rendimiento cr√≠tico |
| 5.6 - 6.2 | 25% | Calidad aceptable |
| 6.3 - 6.7 | 25% | Buena recepci√≥n |
| 6.8 - 10.0 | 25% | Excelencia cinematogr√°fica |

**Conclusiones**:
- Rating promedio de **6.08/10** indica est√°ndares de calidad moderadamente altos
- **Solo el 25% supera 6.7/10**, demostrando dificultad de lograr excelencia consistente
- Correlaci√≥n d√©bil entre presupuesto y rating: **dinero no garantiza calidad**
- Pel√≠culas de bajo presupuesto (<$10M) pueden alcanzar ratings altos con gui√≥n s√≥lido
- Estrategia: Invertir en desarrollo de gui√≥n y direcci√≥n, no solo en efectos especiales

#### üåê Diversidad Ling√º√≠stica
| M√©trica | Valor | Tendencia |
|---------|-------|-----------|
| **Pel√≠culas Multiling√ºes** | 20,031 combinaciones | En aumento |
| **Promedio idiomas/pel√≠cula** | ~2.5 idiomas | Globalizaci√≥n |
| **Idioma dominante** | Ingl√©s | ~85% de producciones |

**Conclusiones**:
- **Globalizaci√≥n**: Pel√≠culas incorporan m√∫ltiples idiomas para mercados internacionales
- Estrategia de distribuci√≥n global visible desde la fase de producci√≥n
- Pel√≠culas con di√°logos en idiomas locales aumentan penetraci√≥n en mercados espec√≠ficos
- Tendencia hacia **contenido inclusivo** para maximizar audiencia global

#### üìà Tendencias Temporales (2015-2017)
| A√±o | Observaci√≥n Clave |
|-----|-------------------|
| **2015** | Mayor diversidad de g√©neros, 23 pa√≠ses productores activos |
| **2016** | Incremento en presupuestos de Science Fiction |
| **2017** | Consolidaci√≥n de mega-producciones (>$200M) |

**Conclusiones**:
- **Escalada presupuestaria**: Inversiones crecientes a√±o tras a√±o
- Mayor participaci√≥n de estudios independientes en 2015-2016
- Tendencia hacia **franquicias y universos cinematogr√°ficos** (mayor inversi√≥n inicial)
- Ciclo de producci√≥n indica planeaci√≥n 2-3 a√±os antes del lanzamiento

#### üí° Recomendaciones Estrat√©gicas

**Para Inversores**:
1. Portafolio balanceado: 60% Action/Adventure, 20% Sci-Fi, 20% nicho
2. Presupuesto √≥ptimo: $20-50M para maximizar ROI
3. Co-producciones UK/Australia para optimizar costos y acceso a mercados

**Para Productoras**:
1. Enfoque en gui√≥n y direcci√≥n sobre efectos especiales
2. Duraci√≥n √≥ptima: 100-110 minutos
3. Estrategia multiling√ºe desde pre-producci√≥n
4. Lanzamientos estrat√©gicos en ventanas √≥ptimas

**Para Estudios Emergentes**:
1. Iniciar con g√©neros nicho (<$10M presupuesto)
2. Aprovechar incentivos fiscales (Australia, UK, Canad√°)
3. Enfoque en calidad sobre cantidad
4. Construir cat√°logo antes de escalar a grandes producciones

---

## üóÇÔ∏è Estructura del Proyecto

```
Proyect_Databricks_Movie_History/
‚îÇ
‚îú‚îÄ‚îÄ README.md                          # Esta documentaci√≥n
‚îÇ
‚îú‚îÄ‚îÄ movie-history-proyect/             # Notebooks de Databricks
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ setup/                         # Configuraci√≥n de conexiones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01.access_adls_using_access_key.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02.access_adls_using_token_sas.ipynb
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 03.access_adls_using_service_principal.ipynb ‚≠ê
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ includes/                      # Funciones y configuraciones compartidas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configuration.ipynb        # Rutas y configuraciones
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ common_functions.ipynb     # Funciones reutilizables
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ bronze/                        # Capa Bronze
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 01.create_bronze_table.ipynb
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ ingestion/                     # Ingesta Bronze ‚Üí Silver
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00-ingestion_all_notebooks.ipynb  # Orquestador
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01-Ingestion_file_movie.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02-ingestion_file_languaje.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 03-ingestion_file_genre.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ... (13 notebooks total)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 13-create_silver_database.ipynb
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ transformation/                # Transformaci√≥n Silver ‚Üí Gold
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00.run_transformation_all_notebooks.ipynb  # Orquestador
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01.results_movies_genre_language.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02.results_country_prod_company.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 03.results_group_movie_genre.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 04.results_group_movie_country.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 05.create_gold_database.ipynb
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 06.results_movie.ipynb
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ analysis/                      # An√°lisis de negocio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01.budget_revenue_country.ipynb
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02.budget_revenue_production_company.ipynb
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ demo/                          # Notebooks de pr√°ctica
‚îÇ       ‚îú‚îÄ‚îÄ 01.filter_demo.ipynb
‚îÇ       ‚îú‚îÄ‚îÄ 02.join_demo.ipynb
‚îÇ       ‚îú‚îÄ‚îÄ 03.aggregation_demo.ipynb
‚îÇ       ‚îî‚îÄ‚îÄ ... (demos de conceptos)
‚îÇ
‚îî‚îÄ‚îÄ gold/                              # Datos procesados (Parquet)
    ‚îú‚îÄ‚îÄ results_movie_genre_language/
    ‚îú‚îÄ‚îÄ results_movie_genre_language_py/
    ‚îú‚îÄ‚îÄ results_movie_genre_language_ext_sql/
    ‚îú‚îÄ‚îÄ results_country_prod_company/
    ‚îú‚îÄ‚îÄ results_group_movie_genre/
    ‚îî‚îÄ‚îÄ results_group_movie_country/
```

---

## üéì Conceptos y T√©cnicas Aplicadas

### Spark & PySpark
- ‚úÖ **DataFrames API**: Manipulaci√≥n de datos distribuidos
- ‚úÖ **Spark SQL**: Queries declarativas sobre DataFrames
- ‚úÖ **Window Functions**: Rankings, agregaciones m√≥viles
- ‚úÖ **Joins**: Inner, outer, complex multi-table joins
- ‚úÖ **Aggregations**: GroupBy, sum, avg, count con m√∫ltiples columnas
- ‚úÖ **Particionamiento**: Optimizaci√≥n de queries y storage
- ‚úÖ **Broadcasting**: Optimizaci√≥n de joins peque√±os

### Delta Lake
- ‚úÖ **ACID Transactions**: Garant√≠as de consistencia
- ‚úÖ **Time Travel**: Versionado de datos
- ‚úÖ **Merge/Upsert**: Actualizaciones incrementales
- ‚úÖ **Schema Evolution**: Adaptaci√≥n a cambios de estructura
- ‚úÖ **Optimizaci√≥n**: Z-ordering, compactaci√≥n

### Dise√±o de Datos
- ‚úÖ **Arquitectura Medallion**: Bronze ‚Üí Silver ‚Üí Gold
- ‚úÖ **Star Schema**: Tablas de dimensiones y hechos
- ‚úÖ **Normalizaci√≥n**: Eliminaci√≥n de redundancias
- ‚úÖ **Desnormalizaci√≥n**: Optimizaci√≥n para analytics
- ‚úÖ **Particionamiento**: Por fecha para performance

### DevOps & Mejores Pr√°cticas
- ‚úÖ **Parametrizaci√≥n**: Widgets para configuraci√≥n din√°mica
- ‚úÖ **Modularizaci√≥n**: Funciones reutilizables
- ‚úÖ **Orquestaci√≥n**: Notebooks maestros para ejecutar pipelines
- ‚úÖ **Logging**: Metadata de auditor√≠a
- ‚úÖ **Versionado**: Control de cambios en notebooks

---

## üîß C√≥mo Ejecutar el Proyecto

### Prerrequisitos

1. **Azure Subscription** activa
2. **Azure Databricks Workspace** aprovisionado
3. **Azure Data Lake Storage Gen2** configurado
4. **Azure Key Vault** con los secretos necesarios
5. **Service Principal** con permisos de "Storage Blob Data Contributor"

### Configuraci√≥n Inicial

1. **Crear Storage Account y Container**
```bash
# Crear storage account
az storage account create \
  --name moviehistory0001 \
  --resource-group <your-rg> \
  --location eastus \
  --sku Standard_LRS \
  --kind StorageV2 \
  --hierarchical-namespace true

# Crear containers
az storage fs create --name bronze --account-name moviehistory0001
az storage fs create --name silver --account-name moviehistory0001
az storage fs create --name gold --account-name moviehistory0001
```

2. **Configurar Service Principal**
```bash
# Crear service principal
az ad sp create-for-rbac -n "movie-history-sp"

# Asignar rol
az role assignment create \
  --role "Storage Blob Data Contributor" \
  --assignee <service-principal-id> \
  --scope /subscriptions/<sub-id>/resourceGroups/<rg>/providers/Microsoft.Storage/storageAccounts/moviehistory0001
```

3. **Crear Secrets en Databricks**
```python
# En Databricks CLI o UI
databricks secrets create-scope --scope movie-history-secret-scope
databricks secrets put --scope movie-history-secret-scope --key client-id
databricks secrets put --scope movie-history-secret-scope --key tenant-id
databricks secrets put --scope movie-history-secret-scope --key client-secret
```

4. **Montar el Data Lake**
```python
# En notebook de Databricks
dbutils.fs.mount(
  source = "abfss://bronze@moviehistory0001.dfs.core.windows.net/",
  mount_point = "/mnt/moviehistory0001/bronze",
  extra_configs = configs
)
```

### Ejecuci√≥n del Pipeline

#### Opci√≥n 1: Ejecuci√≥n Manual
1. Ejecutar notebooks de `setup/` para configurar conexi√≥n
2. Ejecutar notebooks de `bronze/` para crear tablas
3. Ejecutar notebooks de `ingestion/` (01-13)
4. Ejecutar notebooks de `transformation/` (01-06)
5. Ejecutar notebooks de `analysis/` seg√∫n necesidad

#### Opci√≥n 2: Ejecuci√≥n Orquestada
```python
# Ejecutar notebook orquestador de ingesta
%run ./ingestion/00-ingestion_all_notebooks

# Ejecutar notebook orquestador de transformaci√≥n
%run ./transformation/00.run_transformation_all_notebooks
```

#### Opci√≥n 3: Azure Data Factory (Producci√≥n)
- Crear pipelines en ADF
- Configurar triggers (schedule, event-based)
- Monitoreo centralizado

---

## üìö Lecciones Aprendidas

### Desaf√≠os y Soluciones

1. **Manejo de JSON complejo**
   - **Desaf√≠o**: JSON con estructuras anidadas (person.json)
   - **Soluci√≥n**: Uso de `STRUCT` types en Spark schemas

2. **Performance en Joins**
   - **Desaf√≠o**: Joins lentos en datasets grandes
   - **Soluci√≥n**: Broadcasting de tablas peque√±as, particionamiento estrat√©gico

3. **Gesti√≥n de Duplicados**
   - **Desaf√≠o**: Datos duplicados en cargas incrementales
   - **Soluci√≥n**: Implementaci√≥n de merge/upsert con Delta Lake

4. **Versionado de Datos**
   - **Desaf√≠o**: Necesidad de auditor√≠a y rollback
   - **Soluci√≥n**: Delta Lake time travel y metadata de auditor√≠a

### Mejores Pr√°cticas Aplicadas

‚úÖ **Separation of Concerns**: Configuraci√≥n separada de l√≥gica  
‚úÖ **DRY Principle**: Funciones reutilizables en common_functions  
‚úÖ **Idempotencia**: Pipelines que pueden re-ejecutarse sin efectos adversos  
‚úÖ **Parametrizaci√≥n**: Widgets para configuraci√≥n flexible  
‚úÖ **Data Quality**: Validaciones de esquema y tipos de datos  
‚úÖ **Security**: Uso de Service Principal y secrets management  
‚úÖ **Observability**: Metadata de auditor√≠a en todas las capas  

---

## üöÄ Pr√≥ximos Pasos y Mejoras

### Mejoras Planificadas

- [ ] **Implementar Data Quality Framework**
  - Great Expectations para validaciones
  - Alertas autom√°ticas en caso de anomal√≠as
  
- [ ] **Orquestaci√≥n Avanzada**
  - Migraci√≥n a Azure Data Factory
  - Implementar CI/CD con Azure DevOps
  
- [ ] **Monitoreo y Alertas**
  - Dashboards de monitoreo con Azure Monitor
  - Alertas por email/Slack para fallos
  
- [ ] **Optimizaciones de Performance**
  - Z-ordering en tablas Delta
  - Compactaci√≥n autom√°tica de archivos
  - Caching estrat√©gico
  
- [ ] **An√°lisis Avanzados**
  - Machine Learning con MLflow
  - Predicci√≥n de ingresos de pel√≠culas
  - An√°lisis de sentimiento de rese√±as
  
- [ ] **Visualizaci√≥n**
  - Dashboards interactivos con Power BI
  - Integraci√≥n con Databricks SQL Dashboards

---

## ü§ù Contribuciones y Contacto

Este proyecto fue desarrollado como parte de mi portfolio profesional de ingenier√≠a de datos.

**Autor**: [Jean Mangones N]   
**GitHub**: [github.com/Jeancmn](https://github.com/Jeancmn)

---

---

## üôè Agradecimientos

- **Azure Databricks Documentation** por recursos educativos
- **Delta Lake Community** por la excelente tecnolog√≠a open-source
- **Databricks Academy** por los cursos y certificaciones

---

## üìä Evidencias Visuales

### Arquitectura Implementada

```
Azure Cloud
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ Azure Entra ID (Service Principal)
    ‚îÇ         ‚îÇ
    ‚îÇ         ‚îú‚îÄ‚îÄ‚îÄ Authentication
    ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ RBAC
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ Azure Key Vault
    ‚îÇ         ‚îÇ
    ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ Secrets (client-id, tenant-id, client-secret)
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ Azure Data Lake Gen2 (moviehistory0001)
    ‚îÇ         ‚îÇ
    ‚îÇ         ‚îú‚îÄ‚îÄ‚îÄ /bronze  (CSV, JSON raw files)
    ‚îÇ         ‚îú‚îÄ‚îÄ‚îÄ /silver  (Delta Tables - cleaned)
    ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ /gold    (Delta Tables - aggregated)
    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ Azure Databricks
              ‚îÇ
              ‚îú‚îÄ‚îÄ‚îÄ Cluster Configuration
              ‚îú‚îÄ‚îÄ‚îÄ Notebooks (PySpark + SQL)
              ‚îú‚îÄ‚îÄ‚îÄ Jobs & Workflows
              ‚îî‚îÄ‚îÄ‚îÄ Delta Lake Engine
```

### Pipeline Flow

```
1. INGESTION (Bronze ‚Üí Silver)
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Source Data (CSV/JSON)                  ‚îÇ
   ‚îÇ   ‚Ä¢ movie.csv (4,500 pel√≠culas)         ‚îÇ
   ‚îÇ   ‚Ä¢ language.csv, genre.csv             ‚îÇ
   ‚îÇ   ‚Ä¢ person.json (nested structure)      ‚îÇ
   ‚îÇ   ‚Ä¢ movie_cast.json (multiline)         ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Transformations                         ‚îÇ
   ‚îÇ   ‚Ä¢ Schema validation                   ‚îÇ
   ‚îÇ   ‚Ä¢ Column renaming                     ‚îÇ
   ‚îÇ   ‚Ä¢ Data type casting                   ‚îÇ
   ‚îÇ   ‚Ä¢ Add metadata (ingestion_date)       ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Silver Layer (Delta Tables)             ‚îÇ
   ‚îÇ   ‚Ä¢ Partitioned by file_date            ‚îÇ
   ‚îÇ   ‚Ä¢ ACID transactions                   ‚îÇ
   ‚îÇ   ‚Ä¢ Merge/Upsert operations             ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

2. TRANSFORMATION (Silver ‚Üí Gold)
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Silver Tables                           ‚îÇ
   ‚îÇ   ‚Ä¢ movies, genres, languages           ‚îÇ
   ‚îÇ   ‚Ä¢ countries, companies                ‚îÇ
   ‚îÇ   ‚Ä¢ bridge tables                       ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Business Logic                          ‚îÇ
   ‚îÇ   ‚Ä¢ Multi-table joins                   ‚îÇ
   ‚îÇ   ‚Ä¢ Aggregations (sum, avg, count)      ‚îÇ
   ‚îÇ   ‚Ä¢ Window functions (ranking)          ‚îÇ
   ‚îÇ   ‚Ä¢ Filtering (year >= 2000)            ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Gold Layer (Analytics)                  ‚îÇ
   ‚îÇ   ‚Ä¢ results_movie_genre_language        ‚îÇ
   ‚îÇ   ‚Ä¢ results_country_prod_company        ‚îÇ
   ‚îÇ   ‚Ä¢ results_group_movie_genre           ‚îÇ
   ‚îÇ   ‚Ä¢ results_group_movie_country         ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

3. ANALYSIS (Consumption)
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Business Intelligence                   ‚îÇ
   ‚îÇ   ‚Ä¢ Budget vs Revenue analysis          ‚îÇ
   ‚îÇ   ‚Ä¢ Top performing countries            ‚îÇ
   ‚îÇ   ‚Ä¢ Genre trends over time              ‚îÇ
   ‚îÇ   ‚Ä¢ Company profitability               ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìñ Documentaci√≥n T√©cnica Adicional

### Convenciones de Nomenclatura

- **Bases de datos**: `movie_bronze`, `movie_silver`, `movie_gold`
- **Tablas**: snake_case (e.g., `movies_genres`, `production_companies`)
- **Columnas**: snake_case (e.g., `movie_id`, `release_date`)
- **Notebooks**: Numeraci√≥n secuencial (e.g., `01-Ingestion_file_movie.ipynb`)
- **Funciones**: snake_case (e.g., `add_ingestion_date`, `merge_delta_lake`)

### Estrategia de Particionamiento

- **Silver Layer**: Particionado por `file_date` para cargas incrementales
- **Gold Layer**: Particionado por `created_date` para versionado de resultados

### Gesti√≥n de Versiones

```sql
-- Delta Lake Time Travel
SELECT * FROM movie_gold.results_movie_genre_language VERSION AS OF 1
SELECT * FROM movie_gold.results_movie_genre_language TIMESTAMP AS OF '2024-12-30'

-- Historia de cambios
DESC HISTORY movie_gold.results_movie_genre_language
```

---

**Este proyecto demuestra competencias en**:
- ‚òëÔ∏è Dise√±o e implementaci√≥n de pipelines de datos escalables
- ‚òëÔ∏è Arquitectura de datos enterprise (Medallion)
- ‚òëÔ∏è Procesamiento distribuido con Apache Spark
- ‚òëÔ∏è Servicios cloud de Azure (Databricks, ADLS, Key Vault)
- ‚òëÔ∏è Seguridad y gobernanza de datos
- ‚òëÔ∏è SQL y PySpark avanzado
- ‚òëÔ∏è Delta Lake y ACID transactions
- ‚òëÔ∏è Mejores pr√°cticas de ingenier√≠a de software en datos

---

‚≠ê **Si este proyecto te result√≥ √∫til, considera darle una estrella en GitHub!**